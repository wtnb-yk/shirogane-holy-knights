# Database Schema

## 概要

- **データベース**: PostgreSQL 14
- **データベース名**: shirogane

## テーブル一覧

| テーブル名                 | 分類      | 目的                      |
|-----------------------|---------|-------------------------|
| videos                | 動画関連    | 動画のメイン情報と公開日を管理         |
| video_types           | 動画関連    | 動画タイプマスター（stream/video） |
| video_video_types     | 動画関連    | 動画とタイプの中間テーブル           |
| stream_details        | 動画関連    | 配信詳細情報（配信開始時刻等）         |
| video_tags            | タグ・分類   | 動画用タグマスター               |
| video_video_tags      | タグ・分類   | 動画とタグの中間テーブル            |
| stream_tags           | タグ・分類   | 配信用タグマスター               |
| video_stream_tags     | タグ・分類   | 配信とタグの中間テーブル            |
| channels              | チャンネル関連 | チャンネル情報                 |
| news                  | ニュース関連  | ニュース情報（コンテンツ含む統合テーブル）   |
| news_categories       | ニュース関連  | ニュースカテゴリマスター            |
| databasechangelog     | システム    | Liquibaseマイグレーション履歴     |
| databasechangeloglock | システム    | Liquibaseマイグレーションロック    |

## 設計上の特徴

### パフォーマンス最適化
1. **検索最適化**
   - `videos.description`に対するGINインデックス（全文検索用）
   - 日付関連フィールドでの降順インデックス

2. **参照最適化**  
   - 頻繁に使用される外部キーにインデックス設定
   - 複合インデックスによる効率的な絞り込み

### データ整合性
1. **CASCADE制約**
   - 親レコード削除時の子レコード自動削除
   - データの整合性を保持

2. **RESTRICT制約**
   - マスターデータの誤削除防止（video_types等）

## 拡張性
1. **中間テーブル設計**
   - 多対多関係の適切な正規化
   - 将来的な属性追加に対する柔軟性

2. **タイムスタンプ管理**
   - 全テーブルに`created_at`フィールド
   - データ追跡・監査対応

## マイグレーションとバージョン管理

### マイグレーション管理
- Liquibaseによるスキーマ変更管理
- `db/changelog/`配下でマイグレーションファイルを管理
