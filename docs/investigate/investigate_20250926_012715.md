# SongDetailModal レスポンシブデザイン改善調査結果

## 調査概要
**調査日**: 2025-09-26
**対象**: SongDetailModalのレスポンシブデザイン改善
**要件**: デスクトップではモーダル、画面幅が狭い時にModalまたはBottomSheetの選択肢検討
**追加要件**: 他の画面でも同様の切り替えが必要なため共通コンポーネント化が必要

## 現状分析

### 1. 対象ファイル構造
```
SongDetailModal関連:
- /frontend/src/features/songs/components/display/modals/SongDetailModal.tsx
- /frontend/src/app/songs/page.tsx (使用箇所)

既存のレスポンシブパターン:
- /frontend/src/app/calendar/page.tsx (DayEventsModal/DayEventsBottomSheet)
- /frontend/src/components/common/BottomSheet/BottomSheet.tsx
- /frontend/src/components/ui/Modal.tsx
```

### 2. 現在の実装状況
- **SongDetailModal**: 常にModalコンポーネントを使用
- **CalendarPage**: 既にModal（デスクトップ）/BottomSheet（モバイル）の切り替えを実装済み
- **useViewport**: lg:1024px基準のデスクトップ/モバイル判定フック存在

### 3. 既存の成功パターン（CalendarPage）
```typescript
// デスクトップ: DayEventsModal
<DayEventsModal
  date={selectedDate}
  events={selectedDateEvents}
  isOpen={isDayEventsModalOpen}
  onClose={() => setIsDayEventsModalOpen(false)}
  onEventClick={handleEventClickFromDayModal}
/>

// モバイル: BottomSheet（lg:hidden）
<div className="lg:hidden">
  <DayEventsBottomSheet
    date={selectedDate}
    events={selectedDateEvents}
    isOpen={isDayEventsBottomSheetOpen}
    onClose={() => setIsDayEventsBottomSheetOpen(false)}
    onEventClick={handleEventClickFromBottomSheet}
  />
</div>
```

## 技術的制約・可能性

### 利用可能なコンポーネント
- **Modal**: 既存実装、ガラスモルフィズムデザイン適用済み
- **BottomSheet**: 既存実装、モバイル最適化済み
- **useViewport**: 画面サイズ判定フック（lg:1024px基準）

### ブレークポイント
- **デスクトップ**: lg以上（1024px以上）
- **モバイル**: lg未満（1024px未満）

## 既存システムとの整合性

### 1. デザインシステム統一
- CalendarPageで既に実装されているパターンとの整合性
- Tailwind CSSクラスの一貫性（lg:hiddenなど）

### 2. コンポーネント設計
- BottomSheetのAPIはModal互換性を意識した設計
- 共通のprops構造（isOpen, onClose, children）

## 解決方針

### 推奨アプローチ: 共通コンポーネント化
**ResponsiveModal**コンポーネントの新規作成を推奨

#### 1. 設置場所
- `/src/components/ui/ResponsiveModal.tsx`

#### 2. 設計思想
```typescript
interface ResponsiveModalProps {
  isOpen: boolean;
  onClose: () => void;
  children: React.ReactNode;
  title?: ReactNode; // BottomSheet用タイトル
  className?: string;
}
```

#### 3. 内部実装
- `useViewport`フックでデスクトップ/モバイル判定
- デスクトップ: Modal使用
- モバイル: BottomSheet使用
- SSRハイドレーション対応

### メリット
1. **統一性**: 全モーダルで同じレスポンシブ挙動
2. **保守性**: ブレークポイント変更時の一元管理
3. **再利用性**: SongDetailModal以外にも適用可能
4. **既存パターン活用**: CalendarPageの成功パターンを基盤

### 段階的実装計画
1. **Phase 1**: ResponsiveModalコンポーネント作成
2. **Phase 2**: SongDetailModalをResponsiveModalで置換
3. **Phase 3**: 他のモーダル（EventDetailModal等）への適用検討

## 技術的考慮事項

### パフォーマンス
- useViewportによる画面サイズ監視のオーバーヘッドは軽微
- コンポーネントの条件分岐による影響は無視できるレベル

### アクセシビリティ
- Modal、BottomSheet両方でキーボード操作対応済み
- ESCキーでの閉じる動作統一

## 実装推奨度: 高

### 判定理由
1. ユーザビリティの大幅向上
2. 既存の技術基盤活用
3. 将来的な横展開可能性
4. 実装コストの合理性

## 次フェーズへの推奨事項

### PLAN フェーズで検討すべき事項
1. ResponsiveModalの詳細インターフェース設計
2. 既存コンポーネントとの統合方法
3. テストケース設計（デスクトップ/モバイル切り替え）
4. 他モーダルへの適用優先順位

### 期待される成果
- SongDetailModalのモバイル体験向上
- 共通化による開発効率向上
- レスポンシブデザインの統一