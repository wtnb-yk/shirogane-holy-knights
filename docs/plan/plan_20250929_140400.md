# 文字色統一実装計画

## プロジェクト概要
- **策定日時**: 2025年9月29日 14:04
- **目的**: プロジェクト全体でのTailwindCSS文字色使用をglobals.cssベースに統一
- **対象**: frontend/src/app/globals.cssの文字色定義を基準とした全体統一
- **方針**: 段階的実装による安全性確保、破壊的変更なし

## 調査結果サマリー
- **調査完了**: docs/investigate/investigate_20250929_135042.md
- **対象ファイル数**: 13ファイル（汎用グレー色）+ globals.css
- **技術環境**: TailwindCSS v4.1.13、Next.js v15.1.6
- **リスク評価**: 低（既存色値保持、段階的実装）

## 実装フェーズ詳細

### Phase 1（最優先）: 汎用グレー色統一
**目的**: `text-gray-*` クラスの `text-text-*` への統一

**対象ファイル** (13ファイル):
1. `/src/components/Image/OptimizedImage.tsx`
2. `/src/features/songs/components/player/PlayerSection.tsx`
3. `/src/features/archives/components/cards/internals/ArchiveCardTags.tsx`
4. `/src/components/Navigation/Pagination.tsx`
5. `/src/components/Layout/PageTitle.tsx`
6. `/src/components/Layout/PageLayout.tsx`
7. `/src/components/Feedback/Toast.tsx`
8. `/src/components/Error/ErrorDisplay.tsx`
9. `/src/components/Error/ErrorBoundary.tsx`
10. `/src/features/calendar/components/calender/internals/CalendarGrid.tsx`
11. `/src/features/calendar/components/calender/internals/CalendarWeekHeader.tsx`
12. `/src/features/calendar/components/calender/internals/CalendarDateCell.tsx`
13. `/src/features/calendar/components/calender/internals/MobileDateSection.tsx`

**置換ルール**:
- `text-gray-400` → `text-text-tertiary`
- `text-gray-500`, `text-gray-600` → `text-text-secondary`
- `text-gray-700`, `text-gray-800`, `text-gray-900` → `text-text-primary`

**期間**: 1-2時間

### Phase 2（高優先）: 機能的状態色統一
**目的**: エラー、成功、警告、情報色の統一とglobals.css追加

**globals.css追加内容**:
```css
/* 機能的な色 */
--color-text-danger: #DC2626;        /* text-red-600相当 */
--color-text-danger-dark: #991B1B;   /* text-red-800相当 */
--color-text-success: #059669;       /* text-green-600相当 */
--color-text-success-dark: #065F46;  /* text-green-800相当 */
--color-text-warning: #D97706;       /* text-yellow-600相当 */
--color-text-warning-dark: #92400E;  /* text-yellow-800相当 */
--color-text-info: #2563EB;          /* text-blue-600相当 */
--color-text-info-dark: #1E40AF;     /* text-blue-800相当 */
--color-text-timeout: #EA580C;       /* text-orange-600相当 */
```

**対象ファイル**:
- Toast.tsx, ErrorDisplay.tsx, ErrorBoundary.tsx 等

**期間**: 30分

### Phase 3（中優先）: 特定用途色統一
**目的**: Pagination、Calendar特定色の統一

**globals.css追加内容**:
```css
/* 特定用途色 */
--color-text-pagination-hover: #B45309;   /* text-amber-700相当 */
--color-text-pagination-active: #78350F;  /* text-amber-900相当 */
--color-text-sunday: #EF4444;             /* text-red-500相当 */
--color-text-saturday: #3B82F6;           /* text-blue-500相当 */
```

**対象ファイル**:
- Pagination.tsx, Calendar系コンポーネント

**期間**: 30分

## ファイル変更計画
### 変更種別
- **修正**: 14ファイル（13コンポーネント + globals.css）
- **新規作成**: なし
- **削除**: なし

### 変更内容
- **文字色クラス名の置換のみ**
- **CSS変数の追加のみ**
- **色の値や視覚的変化はなし**

### 影響範囲
- **UI/UX**: 影響なし（同じ色値での置換）
- **パフォーマンス**: 影響最小限
- **他機能**: 影響なし

## テスト戦略

### 1. E2Eテスト（Playwright MCPツール - 必須）
**目的**: 色の変更が視覚的に影響しないことを確認

**テスト対象コンポーネント**:
- Layout: PageTitle, PageLayout
- Navigation: Pagination
- Content: OptimizedImage, ArchiveCardTags
- Player: PlayerSection
- Calendar: CalendarGrid, CalendarWeekHeader, CalendarDateCell, MobileDateSection
- Feedback: Toast, ErrorDisplay, ErrorBoundary

**テスト手順**:
1. Phase実装前後でスクリーンショット撮影
2. 視覚的差異がないことを確認
3. レスポンシブ表示確認
4. 各機能の動作確認

### 2. 統合テスト
- CSS変数が正しく適用されているか確認
- 各画面サイズでの表示確認
- ブラウザ互換性確認

### 3. 単体テスト
- globals.cssで定義した変数の読み込み確認
- 置換後のクラス名が正しく適用されるか確認
- ビルドプロセスでのエラー有無確認

### 4. 段階的テストアプローチ
- 各Phase完了後に上記テストを実行
- 問題がないことを確認してから次のPhaseに進む
- エラー発生時は即座にロールバック

## リスク分析と対策

### 1. 技術的リスク

#### CSS変数の認識不良
- **可能性**: 低（TailwindCSS v4.1.13でサポート済み）
- **影響度**: 中（スタイルが適用されない）
- **対策**:
  - Phase 1実装後に各コンポーネントでCSS変数の適用確認
  - ブラウザ開発者ツールでCSS変数の読み込み確認

#### TailwindCSSのビルドエラー
- **可能性**: 低（既存の色値を保持）
- **影響度**: 高（ビルド失敗）
- **対策**:
  - 各Phase後に必ずビルドテスト実行
  - エラー発生時は即座にロールバック

### 2. 視覚的リスク

#### 意図しない色の変化
- **可能性**: 低（同じ色値での置換）
- **影響度**: 中（ユーザー体験への影響）
- **対策**:
  - 実装前後でスクリーンショット比較
  - Playwright MCPツールでの包括的視覚確認

#### レスポンシブデザインの破綻
- **可能性**: 低（色のみの変更）
- **影響度**: 中（モバイル表示への影響）
- **対策**:
  - 各画面サイズでのテスト実行
  - モバイル特有コンポーネント（MobileDateSection）の重点確認

### 3. 運用リスク

#### 段階的実装での一貫性欠如
- **可能性**: 中（Phase間での混在）
- **影響度**: 低（一時的な不統一）
- **対策**:
  - 各Phase完了を厳密に管理
  - 中途半端な状態でのコミット禁止

#### 未発見のファイル存在
- **可能性**: 低（詳細調査済み）
- **影響度**: 中（統一の不完全性）
- **対策**:
  - 実装完了後に全体検索で確認
  - 残存する未統一箇所の洗い出し

### 4. 総合リスク評価
- **全体リスク**: **低**
- **破壊的変更**: なし
- **ロールバック容易性**: 高
- **段階的実装による安全性**: 高

## 実装スケジュール

### タイムライン
1. **Phase 1**: 1-2時間（汎用グレー色統一）
2. **Phase 2**: 30分（機能的状態色統一）
3. **Phase 3**: 30分（特定用途色統一）
4. **最終テスト**: 30分（包括的E2E確認）

### 合計予想時間: 2.5-3.5時間

### マイルストーン
- [ ] Phase 1完了: 13ファイルの汎用グレー色統一
- [ ] Phase 2完了: 機能的状態色の統一
- [ ] Phase 3完了: 特定用途色の統一
- [ ] 最終確認完了: E2Eテストでの包括的確認

## 成功基準

### 必須条件
1. **全ての対象ファイルでの色統一完了**
2. **視覚的変化なし**（E2Eテストで確認）
3. **globals.cssでの一元管理実現**
4. **ビルドエラーなし**

### 期待効果
1. **デザインシステムの一貫性向上**
   - 全体で統一された文字色定義
   - 将来的な色変更時の一元管理

2. **保守性の向上**
   - 色変更時は globals.css のみの修正で対応
   - コードの可読性とメンテナンス性向上

3. **開発効率の向上**
   - 色選択時の迷いを削減
   - 統一されたネーミング規則

## 次フェーズへの移行条件

### IMPLEMENTフェーズ移行準備完了
- **調査完了**: ✅
- **計画策定完了**: ✅
- **リスク評価完了**: ✅
- **テスト戦略確定**: ✅

### 推奨事項
1. **実装推奨**: feature/text-color-unificationブランチでの段階的実装
2. **優先度**: 中（破壊的変更なし、段階的実装可能）
3. **必要リソース**: 開発者1名、実装時間約2.5-3.5時間
4. **テスト方針**: Playwright MCPツールでの包括的E2E確認必須

## 計画策定完了判定
- [x] 全ての実装タスクを詳細に分解済み
- [x] リスク分析と対策を完了
- [x] テスト戦略を確定
- [x] スケジュールを策定
- [x] 成功基準を明確化

**ステータス**: 計画策定完了（実装フェーズ移行推奨）